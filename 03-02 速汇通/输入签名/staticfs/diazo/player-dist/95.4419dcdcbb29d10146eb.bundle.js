(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{2703:function(t,i,e){var s,a;s=[e(99),e(27)],void 0===(a=function(t,i){"use strict";var s=e(0);t=s(t),i=s(i),function(){function e(e,s,a){var r=this,h=function(t,i){return~~(Math.random()*(i-t+1)+t)};r.init=function(){r.dt=0,r.oldTime=Date.now(),r.canvas=e,r.canvasContainer=r.canvas.parentNode;document.getElementById("canvas-container");r.canvas.onselectstart=function(){return!1},r.canvas.width=r.cw=s,r.canvas.height=r.ch=a,r.particles=[],r.partCount=30,r.fireworks=[],r.mx=r.cw/2,r.my=r.ch/2,r.currentHue=170,r.partSpeed=5,r.partSpeedVariance=10,r.partWind=50,r.partFriction=5,r.partGravity=1,r.hueMin=150,r.hueMax=200,r.fworkSpeed=2,r.fworkAccel=4,r.hueVariance=30,r.flickerDensity=20,r.showShockwave=!1,r.showTarget=!0,r.clearAlpha=25,r.ctx=r.canvas.getContext("2d"),r.ctx.lineCap="round",r.ctx.lineJoin="round",r.lineWidth=1,window.$&&r.bindEvents(),r.canvasLoop(),r.canvas.onselectstart=function(){return!1}};var o=function(t,i,e){this.x=t,this.y=i,this.coordLast=[{x:t,y:i},{x:t,y:i},{x:t,y:i}],this.angle=h(0,360),this.speed=h(r.partSpeed-r.partSpeedVariance<=0?1:r.partSpeed-r.partSpeedVariance,r.partSpeed+r.partSpeedVariance),this.friction=1-r.partFriction/100,this.gravity=r.partGravity/2,this.hue=h(e-r.hueVariance,e+r.hueVariance),this.brightness=h(50,80),this.alpha=h(40,100)/100,this.decay=h(10,50)/1e3,this.wind=(h(0,r.partWind)-r.partWind/2)/25,this.lineWidth=r.lineWidth};o.prototype.update=function(i){var e,s,a,h,o,n,c,d,u,l=this.angle*Math.PI/180,p=Math.cos(l)*this.speed,f=Math.sin(l)*this.speed+this.gravity;(this.speed*=this.friction,this.coordLast[2].x=this.coordLast[1].x,this.coordLast[2].y=this.coordLast[1].y,this.coordLast[1].x=this.coordLast[0].x,this.coordLast[1].y=this.coordLast[0].y,this.coordLast[0].x=this.x,this.coordLast[0].y=this.y,this.x+=p*r.dt,this.y+=f*r.dt,this.angle+=this.wind,this.alpha-=this.decay,s=0,a=0,h=r.cw,o=r.ch,n=this.x-this.radius,c=this.y-this.radius,d=2*this.radius,u=2*this.radius,s+h<n||n+d<s||a+o<c||c+u<a||this.alpha<.05)&&(0,t.default)(e=r.particles).call(e,i,1)},o.prototype.draw=function(){var t=h(1,3)-1;if(r.ctx.beginPath(),r.ctx.moveTo(Math.round(this.coordLast[t].x),Math.round(this.coordLast[t].y)),r.ctx.lineTo(Math.round(this.x),Math.round(this.y)),r.ctx.closePath(),r.ctx.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+this.alpha+")",r.ctx.stroke(),r.flickerDensity>0){var e=50-r.flickerDensity;if(h(0,e)===e){var s;r.ctx.beginPath(),r.ctx.arc(Math.round(this.x),Math.round(this.y),h(this.lineWidth,this.lineWidth+3)/2,0,2*Math.PI,!1),r.ctx.closePath();var a=h(50,100)/100;r.ctx.fillStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+a+")",(0,i.default)(s=r.ctx).call(s)}}},r.createParticles=function(t,i,e){for(var s=r.partCount;s--;)r.particles.push(new o(t,i,e))},r.updateParticles=function(){for(var t=r.particles.length;t--;){r.particles[t].update(t)}},r.drawParticles=function(){for(var t=r.particles.length;t--;){r.particles[t].draw()}};var n=function(t,i,e,s){this.x=t,this.y=i,this.startX=t,this.startY=i,this.hitX=!1,this.hitY=!1,this.coordLast=[{x:t,y:i},{x:t,y:i},{x:t,y:i}],this.targetX=e,this.targetY=s,this.speed=r.fworkSpeed,this.angle=Math.atan2(s-i,e-t),this.shockwaveAngle=Math.atan2(s-i,e-t)+Math.PI/180*90,this.acceleration=r.fworkAccel/100,this.hue=r.currentHue,this.brightness=h(50,80),this.alpha=h(50,100)/100,this.lineWidth=r.lineWidth,this.targetRadius=1};n.prototype.update=function(i){r.ctx.lineWidth=this.lineWidth;var e=Math.cos(this.angle)*this.speed,s=Math.sin(this.angle)*this.speed;if(this.speed*=1+this.acceleration,this.coordLast[2].x=this.coordLast[1].x,this.coordLast[2].y=this.coordLast[1].y,this.coordLast[1].x=this.coordLast[0].x,this.coordLast[1].y=this.coordLast[0].y,this.coordLast[0].x=this.x,this.coordLast[0].y=this.y,r.showTarget&&(this.targetRadius<8?this.targetRadius+=.25*r.dt:this.targetRadius=1*r.dt),this.startX>=this.targetX?this.x+e<=this.targetX?(this.x=this.targetX,this.hitX=!0):this.x+=e*r.dt:this.x+e>=this.targetX?(this.x=this.targetX,this.hitX=!0):this.x+=e*r.dt,this.startY>=this.targetY?this.y+s<=this.targetY?(this.y=this.targetY,this.hitY=!0):this.y+=s*r.dt:this.y+s>=this.targetY?(this.y=this.targetY,this.hitY=!0):this.y+=s*r.dt,this.hitX&&this.hitY){var a;h(0,9);r.createParticles(this.targetX,this.targetY,this.hue),(0,t.default)(a=r.fireworks).call(a,i,1)}},n.prototype.draw=function(){r.ctx.lineWidth=this.lineWidth;var t=h(1,3)-1;r.ctx.beginPath(),r.ctx.moveTo(Math.round(this.coordLast[t].x),Math.round(this.coordLast[t].y)),r.ctx.lineTo(Math.round(this.x),Math.round(this.y)),r.ctx.closePath(),r.ctx.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+this.alpha+")",r.ctx.stroke(),r.showTarget&&(r.ctx.save(),r.ctx.beginPath(),r.ctx.arc(Math.round(this.targetX),Math.round(this.targetY),this.targetRadius,0,2*Math.PI,!1),r.ctx.closePath(),r.ctx.lineWidth=1,r.ctx.stroke(),r.ctx.restore()),r.showShockwave&&(r.ctx.save(),r.ctx.translate(Math.round(this.x),Math.round(this.y)),r.ctx.rotate(this.shockwaveAngle),r.ctx.beginPath(),r.ctx.arc(0,0,this.speed/5*1,0,Math.PI,!0),r.ctx.strokeStyle="hsla("+this.hue+", 100%, "+this.brightness+"%, "+h(25,60)/100+")",r.ctx.lineWidth=this.lineWidth,r.ctx.stroke(),r.ctx.restore())},r.createFireworks=function(t,i,e,s){r.fireworks.push(new n(t,i,e,s))},r.updateFireworks=function(){for(var t=r.fireworks.length;t--;){r.fireworks[t].update(t)}},r.drawFireworks=function(){for(var t=r.fireworks.length;t--;){r.fireworks[t].draw()}},r.bindEvents=function(){$(window).on("resize",(function(){clearTimeout(r.timeout),r.timeout=setTimeout((function(){r.ctx.lineCap="round",r.ctx.lineJoin="round"}),100)})),$(r.canvas).on("mousedown",(function(t){h(0,5);r.mx=t.pageX-r.canvasContainer.offset().left,r.my=t.pageY-r.canvasContainer.offset().top,r.currentHue=h(r.hueMin,r.hueMax),r.createFireworks(r.cw/2,r.ch,r.mx,r.my),$(r.canvas).on("mousemove.fireworks",(function(t){h(0,5);r.mx=t.pageX-r.canvasContainer.offset().left,r.my=t.pageY-r.canvasContainer.offset().top,r.currentHue=h(r.hueMin,r.hueMax),r.createFireworks(r.cw/2,r.ch,r.mx,r.my)}))})),$(r.canvas).on("mouseup",(function(t){$(r.canvas).off("mousemove.fireworks")}))},r.clear=function(){r.particles=[],r.fireworks=[],r.ctx.clearRect(0,0,r.cw,r.ch)},r.updateDelta=function(){var t=Date.now();r.dt=(t-r.oldTime)/16,r.dt=r.dt>5?5:r.dt,r.oldTime=t},r.canvasLoop=function(){requestAnimFrame(r.canvasLoop,r.canvas),r.updateDelta(),r.ctx.globalCompositeOperation="destination-out",r.ctx.fillStyle="rgba(0,0,0,"+r.clearAlpha/100+")",r.ctx.fillRect(0,0,r.cw,r.ch),r.ctx.globalCompositeOperation="lighter",r.updateFireworks(),r.updateParticles(),r.drawFireworks(),r.drawParticles()},r.init();setInterval((function(){r.fireworks.push(new n(r.cw/2,r.ch,h(50,r.cw-50),h(50,r.ch/2)-50))}),200)}EpubPlugins.creatClass({pluginName:"fireworks",createdCallback:function(){},attributeChangedCallback:function(){},attachedCallback:function(){this.plugin=new e(this.canvas,this.innerWidth,this.innerHeight)},create:function(){epub360.plugin.create({source:'<epub-fireworks style="pointer-events: none;width:100%;height:100%;position:absolute;overflow:hidden;" ></epub-fireworks>',type:"EpubFireworks"})},focus:function(t,i){},close:function(){},remove:function(){},resize:function(){}})}.call(void 0)}.apply(i,s))||(t.exports=a)}}]);